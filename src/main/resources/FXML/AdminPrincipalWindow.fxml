<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.ToggleButton?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<VBox fx:id="root"
      xmlns="http://javafx.com/javafx/23.0.1"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="Controllers.AdminPrincipalWindowController"
      prefWidth="800.0"
      prefHeight="600.0"
      stylesheets="@../css/AdminPrincipalWindow.css">

  <children>
    <!-- =========================
         1) CABECERA
         ========================= -->
    <HBox fx:id="header"
          styleClass="header"
          prefHeight="79.0"
          spacing="20.0">
      <children>
        <!-- 1.1) Botón “Back” en la cabecera -->
        <Button fx:id="btnBack"
                onAction="#onBackAction"
                styleClass="buttonHeaderIcon">
          <graphic>
            <ImageView fitWidth="24" fitHeight="24"
                       pickOnBounds="true" preserveRatio="true">
              <image>
                <!-- Asegúrate de tener btnBackImage.png en /resources/images/ -->
                <Image url="@../images/btnBackImage.png"/>
              </image>
            </ImageView>
          </graphic>
          <HBox.margin>
            <Insets left="10.0" top="15.0"/>
          </HBox.margin>
        </Button>

        <!-- 1.2) Logo -->
        <ImageView fitWidth="40"
                   fitHeight="40"
                   pickOnBounds="true"
                   preserveRatio="true">
          <image>
            <Image url="@../images/logo.png"/>
          </image>
          <HBox.margin>
            <Insets left="0.0" top="15.0"/>
          </HBox.margin>
        </ImageView>

        <!-- 1.3) Título -->
        <Label text="Panel De Administrador"
               styleClass="textFieldTitle">
          <HBox.margin>
            <Insets left="10.0" top="15.0"/>
          </HBox.margin>
        </Label>

        <!-- Spacer para empujar “Bienvenido” a la derecha -->
        <Region HBox.hgrow="ALWAYS"/>

        <!-- 1.4) “BIENVENIDO” -->
        <Label text="BIENVENIDO"
               styleClass="textFieldGlobal">
          <HBox.margin>
            <Insets top="20.0" right="10.0"/>
          </HBox.margin>
        </Label>

        <!-- 1.5) Nombre de usuario dinámico -->
        <Label fx:id="lblUserName"
               styleClass="textFieldUserName">
          <HBox.margin>
            <Insets top="15.0" right="20.0"/>
          </HBox.margin>
        </Label>
      </children>
    </HBox>

    <!-- =========================
         2) CUERPO PRINCIPAL
         ========================= -->
    <HBox VBox.vgrow="ALWAYS">
      <!-- === 2.1) MENÚ LATERAL === -->
      <VBox fx:id="sidebar"
            styleClass="sidebar"
            alignment="TOP_CENTER"
            prefWidth="189.0"
            spacing="15.0">
        <children>
          <Label text="Opciones" styleClass="textFieldGlobal"/>

          <!-- Botón para colapsar/expandir el sidebar -->
          <Button fx:id="btnToggleSidebar"
                  text="☰"
                  onAction="#onToggleSidebar"
                  styleClass="buttonSmall">
            <VBox.margin>
              <Insets bottom="10.0"/>
            </VBox.margin>
          </Button>

          <!-- ToggleButtons -->
          <ToggleButton fx:id="tgViewUsers"
                        text="Usuarios"
                        onAction="#tgShowUsersTable"
                        styleClass="buttonToggle"/>

          <ToggleButton fx:id="tgViewRooms"
                        text="Plano"
                        onAction="#tgShowRoomTable"
                        styleClass="buttonToggle"/>

          <ToggleButton fx:id="tgViewReservations"
                        text="Reservas"
                        onAction="#tgShowReservationsTable"
                        styleClass="buttonToggle"/>

          <ToggleButton fx:id="tgViewReports"
                        text="Reportes"
                        onAction="#tgShowReport"
                        styleClass="buttonToggle"/>

          <ToggleButton fx:id="tgCreateAdmin"
                        text="Crear Admin"
                        onAction="#tgCreateAdmin"
                        styleClass="buttonToggle"/>
        </children>
      </VBox>

      <!-- === 2.2) ÁREA DINÁMICA (TABLAS o FORMULARIO) === -->
      <StackPane fx:id="spGeneralContent"
                 HBox.hgrow="ALWAYS"
                 style="-fx-padding: 20;">
        <children>

          <!-- 2.2.1) Tabla de Usuarios con breadcrumb y scroll interno -->
          <VBox spacing="10">
            <!-- Breadcrumb (solo se ve cuando tblUsers es visible) -->
            <HBox fx:id="breadcrumb" spacing="5">
              <children>
                <Label text="Inicio"
                       styleClass="linkBreadcrumb"
                       onMouseClicked="#onBreadcrumbHome"/>
                <Label text=">"/>
                <Label text="Usuarios"/>
              </children>
            </HBox>

            <!-- ScrollPane transparente alrededor de la TableView -->
            <ScrollPane fx:id="spUsersScroll"
                        fitToHeight="true"
                        fitToWidth="true"
                        HBox.hgrow="ALWAYS"
                        styleClass="transparent-scrollpane"
                        prefHeight="450"
                        maxHeight="450">
              <content>
                <TableView fx:id="tblUsers"
                           prefHeight="400"
                           prefWidth="800"
                           visible="true">
                  <columns>
                    <TableColumn fx:id="colId"       prefWidth="150.0" text="Cédula"/>
                    <TableColumn fx:id="colName"     prefWidth="200.0" text="Nombre"/>
                    <TableColumn fx:id="colLastName" prefWidth="200.0" text="Apellido"/>
                    <TableColumn fx:id="colUsername" prefWidth="200.0" text="Usuario"/>
                    <TableColumn fx:id="colEdit"     prefWidth="125.0" text="Editar"/>
                    <TableColumn fx:id="colDelete"   prefWidth="125.0" text="Eliminar"/>
                  </columns>
                </TableView>
              </content>
            </ScrollPane>
          </VBox>

          <!-- 2.2.2) “Plano” -->
          <ScrollPane fx:id="spRoomsScroll"
                      fitToHeight="true"
                      fitToWidth="true"
                      HBox.hgrow="ALWAYS"
                      styleClass="transparent-scrollpane"
                      prefHeight="450"
                      maxHeight="450">
            <content>
              <TableView fx:id="tblRooms"
                         prefHeight="400.0"
                         prefWidth="700.0"
                         visible="false">
                <columns>
                  <TableColumn fx:id="colRoomId"   prefWidth="150.0" text="ID Plano"/>
                  <TableColumn fx:id="colRoomName" prefWidth="250.0" text="Nombre"/>
                  <TableColumn fx:id="colCapacity" prefWidth="150.0" text="Capacidad"/>
                  <TableColumn fx:id="colRoomType" prefWidth="250.0" text="Tipo"/>
                </columns>
              </TableView>
            </content>
          </ScrollPane>

          <!-- 2.2.3) Reservas -->
          <ScrollPane fx:id="spReservationsScroll"
                      fitToHeight="true"
                      fitToWidth="true"
                      HBox.hgrow="ALWAYS"
                      styleClass="transparent-scrollpane"
                      prefHeight="450"
                      maxHeight="450">
            <content>
              <TableView fx:id="tblReservations"
                         prefHeight="400.0"
                         prefWidth="900.0"
                         visible="false">
                <columns>
                  <TableColumn fx:id="colResId"    prefWidth="150.0" text="ID Reserva"/>
                  <TableColumn fx:id="colResUser"  prefWidth="200.0" text="Usuario"/>
                  <TableColumn fx:id="colResRoom"  prefWidth="200.0" text="Plano/Espacio"/>
                  <TableColumn fx:id="colResDate"  prefWidth="200.0" text="Fecha"/>
                  <TableColumn fx:id="colResStart" prefWidth="150.0" text="Inicio"/>
                  <TableColumn fx:id="colResEnd"   prefWidth="150.0" text="Fin"/>
                </columns>
              </TableView>
            </content>
          </ScrollPane>

          <!-- 2.2.4) Reportes -->
          <ScrollPane fx:id="spReportsScroll"
                      fitToHeight="true"
                      fitToWidth="true"
                      HBox.hgrow="ALWAYS"
                      styleClass="transparent-scrollpane"
                      prefHeight="450"
                      maxHeight="450">
            <content>
              <TableView fx:id="tblReports"
                         prefHeight="400.0"
                         prefWidth="700.0"
                         visible="false">
                <columns>
                  <TableColumn fx:id="colReportId"   prefWidth="200.0" text="ID Rep"/>
                  <TableColumn fx:id="colReportName" prefWidth="350.0" text="Descripción"/>
                  <TableColumn fx:id="colReportDate" prefWidth="150.0" text="Fecha"/>
                </columns>
              </TableView>
            </content>
          </ScrollPane>

          <!-- 2.2.5) Formulario “Crear Administrador” -->
          <GridPane fx:id="formAdmin"
                    styleClass="grid-pane"
                    hgap="10.0"
                    vgap="10.0"
                    visible="false">
            <columnConstraints>
              <ColumnConstraints percentWidth="30.0"/>
              <ColumnConstraints percentWidth="70.0"/>
            </columnConstraints>
            <rowConstraints>
              <RowConstraints/>
              <RowConstraints/>
              <RowConstraints/>
              <RowConstraints/>
              <RowConstraints/>
              <RowConstraints/>
            </rowConstraints>
            <children>
              <Label text="Cédula:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
              <TextField fx:id="txtAdminId" GridPane.rowIndex="0" GridPane.columnIndex="1"/>

              <Label text="Nombre:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
              <TextField fx:id="txtAdminName" GridPane.rowIndex="1" GridPane.columnIndex="1"/>

              <Label text="Apellido:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
              <TextField fx:id="txtAdminLastName" GridPane.rowIndex="2" GridPane.columnIndex="1"/>

              <Label text="Usuario:" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
              <TextField fx:id="txtAdminUser" GridPane.rowIndex="3" GridPane.columnIndex="1"/>

              <Label text="Contraseña:" GridPane.rowIndex="4" GridPane.columnIndex="0"/>
              <PasswordField fx:id="txtAdminPass" GridPane.rowIndex="4" GridPane.columnIndex="1"/>

              <Button text="Guardar"
                      onAction="#onCreateAdmin"
                      GridPane.rowIndex="5"
                      GridPane.columnIndex="1"
                      styleClass="button"/>
            </children>
          </GridPane>

        </children>
      </StackPane>
    </HBox>
  </children>
</VBox>
